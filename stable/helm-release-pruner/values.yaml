# Default values for helm-release-pruner
# This is v4.x which uses the Go-based daemon

image:
  # image.repository -- Image repository
  repository: quay.io/fairwinds/helm-release-pruner
  # image.tag -- Image tag (defaults to appVersion)
  tag: "4.0.0-rc.1"
  # image.pullPolicy -- Image pull policy
  pullPolicy: Always

# imagePullSecrets -- Image pull secrets
imagePullSecrets: []

# nameOverride -- Override the chart name
nameOverride: ""
# fullnameOverride -- Override the full release name
fullnameOverride: ""

# -- Pruner configuration options (maps to CLI flags)
pruner:
  # pruner.dryRun -- If true, only log what would be deleted without actually deleting
  dryRun: true
  # pruner.debug -- Enable debug logging
  debug: false

  # pruner.interval -- How often to run the pruning cycle (daemon mode only)
  # Supports Go duration format: "1h", "30m", "6h"
  interval: "1h"

  # pruner.olderThan -- Delete releases older than this duration
  # Supports: Go durations (336h), days (14d), weeks (2w)
  olderThan: ""

  # pruner.maxReleasesToKeep -- Keep only the N most recent releases globally after filtering (0 = no limit)
  maxReleasesToKeep: 0

  # pruner.releaseFilter -- Regex to include matching release names
  releaseFilter: ""
  # pruner.releaseExclude -- Regex to exclude matching release names
  releaseExclude: ""
  # pruner.namespaceFilter -- Regex to include matching namespaces
  namespaceFilter: ""
  # pruner.namespaceExclude -- Regex to exclude matching namespaces
  namespaceExclude: ""

  # pruner.preserveNamespace -- Don't delete namespaces even when empty after release deletion
  preserveNamespace: false

  # pruner.cleanupOrphanNamespaces -- Enable cleanup of namespaces that have no Helm releases
  cleanupOrphanNamespaces: false
  # pruner.orphanNamespaceFilter -- Regex filter for namespaces to consider for orphan cleanup (REQUIRED when using cleanupOrphanNamespaces)
  orphanNamespaceFilter: ""
  # pruner.orphanNamespaceExclude -- Regex to exclude namespaces from orphan cleanup
  orphanNamespaceExclude: ""

  # pruner.systemNamespaces -- Comma-separated list of additional namespaces to never delete
  # (kube-system, kube-public, default, kube-node-lease are always protected)
  systemNamespaces: ""

  # pruner.deleteRateLimit -- Minimum duration between delete operations (0 to disable)
  deleteRateLimit: "100ms"

# replicas -- Number of replicas (should typically be 1)
replicas: 1

# healthAddr -- Address for health check and metrics endpoints
healthAddr: ":8080"

service:
  # service.enabled -- Create a Service for health/metrics endpoints
  enabled: true
  # service.port -- Service port
  port: 8080
  # service.annotations -- Service annotations
  annotations: {}

serviceMonitor:
  # serviceMonitor.enabled -- Create a ServiceMonitor for Prometheus scraping
  enabled: false
  # serviceMonitor.interval -- Scrape interval
  interval: "30s"
  # serviceMonitor.additionalLabels -- Additional labels for the ServiceMonitor
  additionalLabels: {}

serviceAccount:
  # serviceAccount.create -- Create a ServiceAccount
  create: true
  # serviceAccount.name -- Name of an existing ServiceAccount to use (if create is false)
  name: ""
  # serviceAccount.annotations -- Annotations for the ServiceAccount
  annotations: {}

rbac:
  # rbac.create -- Create RBAC resources (ClusterRole, ClusterRoleBinding)
  create: true

# podAnnotations -- Additional annotations for pods
podAnnotations: {}

# podLabels -- Additional labels for pods
podLabels: {}

# resources -- Resource requests and limits
resources:
  limits:
    memory: 128Mi
  requests:
    cpu: 10m
    memory: 32Mi

# nodeSelector -- Node selector for pod scheduling
nodeSelector: {}

# tolerations -- Tolerations for pod scheduling
tolerations: []

# affinity -- Affinity rules for pod scheduling
affinity: {}

# securityContext -- Pod security context
securityContext:
  runAsNonRoot: true
  runAsUser: 10324
  fsGroup: 10324

# containerSecurityContext -- Container security context
containerSecurityContext:
  readOnlyRootFilesystem: true
  allowPrivilegeEscalation: false
  capabilities:
    drop:
      - ALL
