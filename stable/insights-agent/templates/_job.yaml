{{- define "job" }}
apiVersion: batch/v1
kind: Job
metadata:
  {{- if not .Release.Time }}
    {{- $_ := set .Release "Time" (now | unixEpoch) }}
  {{- end }}
  {{- $_ := set . "Label" (printf "%s-%s" .Label .Release.Time) }}
  {{- include "metadata" .Label }}
spec:
  ttlSecondsAfterFinished: 100
  backoffLimit: {{ .Values.cronjobs.backoffLimit }}
  template:
    spec:
      {{- include .Template . | nindent 6 -}}
{{- end }}
