apiVersion: insights.fairwinds.com/v1
kind: CustomCheck
metadata:
  name: must-have-annotation
spec:
  output:
    title: "Annotation is missing"
    severity: 0.1
    remediation: "Add the annotation"
    category: "Reliability"
  rego: |
         package fairwinds
         annotation[description] {
           provided := {annotation | input.metadata.annotations[annotation]}
           required := {annotation | label := input.parameters.annotations[_]}
           missing := required - provided
           count(missing) > 0
           description := sprintf("Annotation %v is missing", [missing])
         }
