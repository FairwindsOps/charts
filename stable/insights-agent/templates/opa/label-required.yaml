apiVersion: insights.fairwinds.com/v1
kind: CustomCheck
metadata:
  name: must-have-label
spec:
  output:
    title: "Label is missing"
    severity: 0.1
    remediation: "Add the label"
    category: "Reliability"
  rego: |
         package fairwinds
         label[description] {
           provided := {label | input.metadata.labels[label]}
           required := {label | label := input.parameters.labels[_]}
           missing := required - provided
           count(missing) > 0
           description := sprintf("Label %v is missing", [missing])
         }
