# -- pre-defined cluster groups
x-clusters:
  devClusters: &devClusters
    - us-east1-dev*
    - us-east2-dev*
  testClusters: &testClusters
    - us-east1-test*
    - us-east2-test*
  prodClusters: &prodClusters
    - us-east1-prod*
    - us-east2-prod*

# -- labels to use when selecting production stuff
x-labelSelectors:
  prodLabels: &prodLabels
    - "env": "prod"


# -- blocking policies
x-policiesBlocking: &blockingPolicies
  - polaris.procMount

x-policiesAudit: &auditPolicies
  - polaris.tagNotSpecified
  - polaris.runAsPrivileged
  - polaris.runAsRootAllowed
  - polaris.privilegeEscalationAllowed
  - polaris.hostPIDSet
  - polaris.hostIPCSet
  - polaris.dangerousCapabilities

# -- All of the appGroups
appGroups:
  # -- dev policy mappings
  dev:
    # -- dev-one
    - name: appGroup_dev-one
      labels:
        - "foo": "bar"
        - "key": "value"
      namespaceLabels:
        - "fargle": "bargle"
      clusters: *devClusters
    # -- dev-two
    - name: appGroup_dev-two
      clusters: *devClusters

  # -- The list of prod appGroups
  prod:
    # -- prod-one
    - name: appGroup_prod-one
      clusters: *prodClusters
      labels: *prodLabels

# -- All of the policyMappings
policyMappings:
  # -- dev policy mappings
  dev:
    ## - dev-blocking
    - name: policyMapping_dev-blocking
      block: true
      appGroups: ["dev-one"]
      policies: *blockingPolicies
    ## - dev-audit
    - name: policyMapping_dev-audit
      block: false
      appGroups: ["dev-one"]
      policies: *auditPolicies

